name = "api"
main = "src/api.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# Workers AI binding for embedding generation
[ai]
binding = "AI"

[[kv_namespaces]]
binding = "CACHE"
id = "b909f0f2d9aa4adc95c91b8230c3f9ad"

[vars]
ORIGIN_URL = "https://megg-api.vercel.app"
# FRONTEND_URL = "https://your-frontend.com" # Uncomment to restrict CORS
DEFAULT_CACHE_TTL = "900"
MAX_CACHE_TTL = "3600"
EMBEDDING_MODEL = "@cf/baai/bge-small-en-v1.5"

[env.production]
name = "megg-api-edge"

[[env.production.kv_namespaces]]
binding = "CACHE"
id = "b909f0f2d9aa4adc95c91b8230c3f9ad"

[env.staging]
name = "megg-api-edge-staging"

[observability]
enabled = true
head_sampling_rate = 1

[observability.logs]
enabled = true
head_sampling_rate = 1
persist = true
invocation_logs = true